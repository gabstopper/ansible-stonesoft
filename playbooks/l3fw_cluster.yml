- name: Firewall Template
  hosts: localhost
  gather_facts: no
  tasks:
  - name: Create a single layer 3 firewall
    l3fw_cluster:
      smc_logging:
        level: 10
        path: /Users/davidlepage/Downloads/ansible-smc.log
      backup_mgt: '2.3'
      cluster_mode: standby
      comment: my new firewall
      default_nat: false
      domain_server_address:
      - 8.8.8.8
      antivirus: false
      file_reputation: false
      interfaces:
      -   interface_id: '1002'
          nodes:
          -   address: 25.25.25.25
              network_value: 25.25.25.25/32
              nodeid: 1
          -   address: 25.25.25.26
              network_value: 25.25.25.25/32
              nodeid: 2
          type: tunnel_interface
      -   cluster_virtual: 24.24.24.24
          interface_id: '1001'
          network_value: 24.24.24.0/24
          nodes:
          -   address: 24.24.24.25
              network_value: 24.24.24.0/24
              nodeid: 1
          -   address: 24.24.24.26
              network_value: 24.24.24.0/24
              nodeid: 2
          type: tunnel_interface
      -   interface_id: '5'
      -   interface_id: '4'
          nodes:
          -   address: 5.5.5.2
              network_value: 5.5.5.0/24
              nodeid: 1
          -   address: 5.5.5.3
              network_value: 5.5.5.0/24
              nodeid: 2
          zone_ref: heartbeat
      -   interface_id: '3'
      -   interface_id: '2'
          nodes:
          -   address: 3.3.3.3
              network_value: 3.3.3.0/24
              nodeid: 2
          -   address: 3.3.3.2
              network_value: 3.3.3.0/24
              nodeid: 1
          vlan_id: '3'
      -   interface_id: '2'
          nodes:
          -   address: 4.4.4.2
              network_value: 4.4.4.0/24
              nodeid: 1
          -   address: 4.4.4.3
              network_value: 4.4.4.0/24
              nodeid: 2
          vlan_id: '4'
          zone_ref: somevlan
      -   cluster_virtual: 2.2.2.1
          interface_id: '1'
          macaddress: 02:02:02:02:02:04
          network_value: 2.2.2.0/24
          nodes:
          -   address: 2.2.2.3
              network_value: 2.2.2.0/24
              nodeid: 2
          -   address: 2.2.2.2
              network_value: 2.2.2.0/24
              nodeid: 1
          zone_ref: internal
      location: somelocation
      name: newcluster
      primary_heartbeat: '4'
      primary_mgt: '1'
      bgp:
        enabled: true
        announced_network:
            - network:
                name: foo
                route_map: newroutemap
            - host:
                name: hostb
            - group:
                name: group1
                route_map: myroutemap
        antispoofing_network:
            network:
                - network-1.1.1.0/24
                - network-172.18.1.0/24
            host:
                - hostb
        autonomous_system:
            name: mynew
            as_number: '123.123'
            comment: foo
        router_id: 1.1.1.1
        bgp_peerings:
            - name: bgppeering
              external_bgp_peer: bgppeer
              interfaces:
                - interface_id: 1
                  network: 2.2.2.0/24
                - interface_id: 1001
                - interface_id: '2.3'
            - name: bgppeering2
              engine: myfw
              interfaces:
                - interface_id: 1002
        #bgp_profile: Use default if not provided
      snmp:
          enabled: true
          snmp_agent: myagent
          snmp_interface:
          - '1'
          - '2.4'
          snmp_location: newcluster
      tags:
      - footag
      #skip_interfaces: true
      #state: absent
