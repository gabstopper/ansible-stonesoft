- name: Firewall Template
  hosts: localhost
  gather_facts: no
  tasks:
  - name: Create a single layer 3 firewall
    l3fw_cluster:
      smc_logging:
        level: 10
        path: /Users/davidlepage/Downloads/ansible-smc.log
      antivirus: false
      bgp:
          announced_network:
          -   network:
                  name: foo
                  route_map: newroutemap
          -   host:
                  name: hostb
          -   group:
                  name: group1
                  route_map: myroutemap
          antispoofing_network:
              group:
              - hostgroup
              host:
              - hostb
              network:
              - network-1.1.1.0/24
              - network-172.18.1.0/24
          autonomous_system:
              as_number: 8061051
              comment: foo
              name: mynew
          bgp_peering:
          -   external_bgp_peer: bgppeer
              interface_id: '21.21'
              name: bgppeering
              network: 22.22.22.0/24
          -   engine: jackson
              interface_id: '67'
              name: bgppeering
              network: 67.67.67.0/24
          bgp_profile: Default BGP Profile
          enabled: true
          router_id: 1.1.1.1
      cluster_mode: standby
      comment: my new firewall
      default_nat: false
      domain_server_address:
      - 8.8.8.8
      file_reputation: false
      interfaces:
      -   interface_id: '10'
          nodes:
          -   address: 11.11.11.1
              network_value: 11.11.11.0/24
              nodeid: 2
          -   address: 11.11.11.2
              network_value: 11.11.11.0/24
              nodeid: 1
      -   interface_id: '1011'
          nodes:
          -   address: 111.111.111.112
              network_value: 111.111.111.0/24
              nodeid: 1
          -   address: 111.111.111.111
              network_value: 111.111.111.0/24
              nodeid: 2
          type: tunnel_interface
      -   interface_id: '1005'
          nodes:
          -   address: 15.15.15.15
              network_value: 15.15.15.0/24
              nodeid: 1
          -   address: 15.15.15.16
              network_value: 15.15.15.0/24
              nodeid: 2
          type: tunnel_interface
      -   interface_id: '1002'
          nodes:
          -   address: 25.25.25.26
              network_value: 25.25.25.25/32
              nodeid: 2
          -   address: 25.25.25.25
              network_value: 25.25.25.25/32
              nodeid: 1
          type: tunnel_interface
      -   interface_id: '1001'
          nodes:
          -   address: 24.24.24.25
              network_value: 24.24.24.0/24
              nodeid: 1
          -   address: 24.24.24.26
              network_value: 24.24.24.0/24
              nodeid: 2
          type: tunnel_interface
      -   comment: no interfaces
          interface_id: '5'
      -   comment: NDIs only
          interface_id: '4'
          nodes:
          -   address: 5.5.5.2
              network_value: 5.5.5.0/24
              nodeid: 1
          -   address: 5.5.5.3
              network_value: 5.5.5.0/24
              nodeid: 2
          zone_ref: heartbeat
      -   interface_id: '3'
      -   cluster_virtual: 67.67.67.67
          comment: CVI only
          interface_id: '67'
          macaddress: 02:02:04:04:04:04
          network_value: 67.67.67.0/24
      -   cluster_virtual: 36.36.36.40
          comment: CVI with NDIs
          interface_id: '24'
          macaddress: 02:02:02:04:02:08
          network_value: 36.36.36.0/24
          nodes:
          -   address: 36.36.36.1
              network_value: 36.36.36.0/24
              nodeid: 1
          -   address: 36.36.36.2
              network_value: 36.36.36.0/24
              nodeid: 2
          vlan_id: '21'
      -   interface_id: '55'
      -   comment: BGP interface
          interface_id: '1050'
          nodes:
          -   address: 101.101.101.1
              network_value: 101.101.101.0/24
              nodeid: 1
          -   address: 101.101.101.2
              network_value: 101.101.101.0/24
              nodeid: 2
          type: tunnel_interface
      -   interface_id: '22'
          macaddress: 02:02:02:02:02:06
      -   comment: delete by api
          interface_id: '6'
          vlan_id: '6'
    #   -   interface_id: '2'
    #       nodes:
    #       -   address: 32.32.32.2
    #           network_value: 32.32.32.0/24
    #           nodeid: 2
    #       -   address: 32.32.32.1
    #           network_value: 32.32.32.0/24
    #           nodeid: 1
    #       vlan_id: '3'
      -   interface_id: '2'
          interfaces:
            nodes:
            -   address: 4.4.4.3
                network_value: 4.4.4.0/24
                nodeid: 2
            -   address: 4.4.4.2
                network_value: 4.4.4.0/24
                nodeid: 1
            vlan_id: '4'
            zone_ref: somevlan
            nodes:
            -   address: 44.44.44.2
                network_value: 44.44.44.0/24
                nodeid: 1
            -   address: 44.44.44.3
                network_value: 44.44.44.0/24
                nodeid: 2
            vlan_id: '5'
            nodes:
            -   address: 26.26.26.2
                network_value: 26.26.26.0/24
                nodeid: 1
            -   address: 26.26.26.3
                network_value: 26.26.26.0/24
                nodeid: 2
            vlan_id: '26'
      -   interface_id: '21'
          macaddress: 02:02:02:02:02:02
          cvi_mode: packetdispatch
          interfaces:
            -   cluster_virtual: 22.22.22.254
                network_value: 22.22.22.0/24
                nodes:
                -   address: 22.22.22.1
                    network_value: 22.22.22.0/24
                    nodeid: 1
                -   address: 22.22.22.2
                    network_value: 22.22.22.0/24
                    nodeid: 2
                vlan_id: '21'
            -   cluster_virtual: 21.21.21.254
                network_value: 21.21.21.0/24
                nodes:
                -   address: 21.21.21.1
                    network_value: 21.21.21.0/24
                    nodeid: 1
                -   address: 21.21.21.2
                    network_value: 21.21.21.0/24
                    nodeid: 2
                vlan_id: '20'
      name: newcluster
      primary_heartbeat: '24.21'
      primary_mgt: '2.26'
      tags:
      - footag2
      - footag
